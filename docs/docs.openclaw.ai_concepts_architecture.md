---
url: "https://docs.openclaw.ai/concepts/architecture"
title: "Architecture - OpenClaw"
---

[Skip to main content](https://docs.openclaw.ai/concepts/architecture#content-area)

[OpenClaw home page![light logo](https://mintcdn.com/clawdhub/4rYvG-uuZrMK_URE/assets/pixel-lobster.svg?fit=max&auto=format&n=4rYvG-uuZrMK_URE&q=85&s=da2032e9eac3b5d9bfe7eb96ca6a8a26)![dark logo](https://mintcdn.com/clawdhub/4rYvG-uuZrMK_URE/assets/pixel-lobster.svg?fit=max&auto=format&n=4rYvG-uuZrMK_URE&q=85&s=da2032e9eac3b5d9bfe7eb96ca6a8a26)](https://docs.openclaw.ai/)

Search...

Ctrl K

Search...

Navigation

On this page

- [Gateway architecture](https://docs.openclaw.ai/concepts/architecture#gateway-architecture)
- [Overview](https://docs.openclaw.ai/concepts/architecture#overview)
- [Components and flows](https://docs.openclaw.ai/concepts/architecture#components-and-flows)
- [Gateway (daemon)](https://docs.openclaw.ai/concepts/architecture#gateway-daemon)
- [Clients (mac app / CLI / web admin)](https://docs.openclaw.ai/concepts/architecture#clients-mac-app-%2F-cli-%2F-web-admin)
- [Nodes (macOS / iOS / Android / headless)](https://docs.openclaw.ai/concepts/architecture#nodes-macos-%2F-ios-%2F-android-%2F-headless)
- [WebChat](https://docs.openclaw.ai/concepts/architecture#webchat)
- [Connection lifecycle (single client)](https://docs.openclaw.ai/concepts/architecture#connection-lifecycle-single-client)
- [Wire protocol (summary)](https://docs.openclaw.ai/concepts/architecture#wire-protocol-summary)
- [Pairing + local trust](https://docs.openclaw.ai/concepts/architecture#pairing-%2B-local-trust)
- [Protocol typing and codegen](https://docs.openclaw.ai/concepts/architecture#protocol-typing-and-codegen)
- [Remote access](https://docs.openclaw.ai/concepts/architecture#remote-access)
- [Operations snapshot](https://docs.openclaw.ai/concepts/architecture#operations-snapshot)
- [Invariants](https://docs.openclaw.ai/concepts/architecture#invariants)

# [​](https://docs.openclaw.ai/concepts/architecture\#gateway-architecture)  Gateway architecture

Last updated: 2026-01-22

## [​](https://docs.openclaw.ai/concepts/architecture\#overview)  Overview

- A single long‑lived **Gateway** owns all messaging surfaces (WhatsApp via
Baileys, Telegram via grammY, Slack, Discord, Signal, iMessage, WebChat).
- Control-plane clients (macOS app, CLI, web UI, automations) connect to the
Gateway over **WebSocket** on the configured bind host (default
`127.0.0.1:18789`).
- **Nodes** (macOS/iOS/Android/headless) also connect over **WebSocket**, but
declare `role: node` with explicit caps/commands.
- One Gateway per host; it is the only place that opens a WhatsApp session.
- A **canvas host** (default `18793`) serves agent‑editable HTML and A2UI.

## [​](https://docs.openclaw.ai/concepts/architecture\#components-and-flows)  Components and flows

### [​](https://docs.openclaw.ai/concepts/architecture\#gateway-daemon)  Gateway (daemon)

- Maintains provider connections.
- Exposes a typed WS API (requests, responses, server‑push events).
- Validates inbound frames against JSON Schema.
- Emits events like `agent`, `chat`, `presence`, `health`, `heartbeat`, `cron`.

### [​](https://docs.openclaw.ai/concepts/architecture\#clients-mac-app-/-cli-/-web-admin)  Clients (mac app / CLI / web admin)

- One WS connection per client.
- Send requests (`health`, `status`, `send`, `agent`, `system-presence`).
- Subscribe to events (`tick`, `agent`, `presence`, `shutdown`).

### [​](https://docs.openclaw.ai/concepts/architecture\#nodes-macos-/-ios-/-android-/-headless)  Nodes (macOS / iOS / Android / headless)

- Connect to the **same WS server** with `role: node`.
- Provide a device identity in `connect`; pairing is **device‑based** (role `node`) and
approval lives in the device pairing store.
- Expose commands like `canvas.*`, `camera.*`, `screen.record`, `location.get`.

Protocol details:

- [Gateway protocol](https://docs.openclaw.ai/gateway/protocol)

### [​](https://docs.openclaw.ai/concepts/architecture\#webchat)  WebChat

- Static UI that uses the Gateway WS API for chat history and sends.
- In remote setups, connects through the same SSH/Tailscale tunnel as other
clients.

## [​](https://docs.openclaw.ai/concepts/architecture\#connection-lifecycle-single-client)  Connection lifecycle (single client)

Copy

```
Client                    Gateway
  |                          |
  |---- req:connect -------->|
  |<------ res (ok) ---------|   (or res error + close)
  |   (payload=hello-ok carries snapshot: presence + health)
  |                          |
  |<------ event:presence ---|
  |<------ event:tick -------|
  |                          |
  |------- req:agent ------->|
  |<------ res:agent --------|   (ack: {runId,status:"accepted"})
  |<------ event:agent ------|   (streaming)
  |<------ res:agent --------|   (final: {runId,status,summary})
  |                          |
```

## [​](https://docs.openclaw.ai/concepts/architecture\#wire-protocol-summary)  Wire protocol (summary)

- Transport: WebSocket, text frames with JSON payloads.
- First frame **must** be `connect`.
- After handshake:
  - Requests: `{type:"req", id, method, params}` → `{type:"res", id, ok, payload|error}`
  - Events: `{type:"event", event, payload, seq?, stateVersion?}`
- If `OPENCLAW_GATEWAY_TOKEN` (or `--token`) is set, `connect.params.auth.token`
must match or the socket closes.
- Idempotency keys are required for side‑effecting methods (`send`, `agent`) to
safely retry; the server keeps a short‑lived dedupe cache.
- Nodes must include `role: "node"` plus caps/commands/permissions in `connect`.

## [​](https://docs.openclaw.ai/concepts/architecture\#pairing-+-local-trust)  Pairing + local trust

- All WS clients (operators + nodes) include a **device identity** on `connect`.
- New device IDs require pairing approval; the Gateway issues a **device token**
for subsequent connects.
- **Local** connects (loopback or the gateway host’s own tailnet address) can be
auto‑approved to keep same‑host UX smooth.
- **Non‑local** connects must sign the `connect.challenge` nonce and require
explicit approval.
- Gateway auth (`gateway.auth.*`) still applies to **all** connections, local or
remote.

Details: [Gateway protocol](https://docs.openclaw.ai/gateway/protocol), [Pairing](https://docs.openclaw.ai/start/pairing),
[Security](https://docs.openclaw.ai/gateway/security).

## [​](https://docs.openclaw.ai/concepts/architecture\#protocol-typing-and-codegen)  Protocol typing and codegen

- TypeBox schemas define the protocol.
- JSON Schema is generated from those schemas.
- Swift models are generated from the JSON Schema.

## [​](https://docs.openclaw.ai/concepts/architecture\#remote-access)  Remote access

- Preferred: Tailscale or VPN.
- Alternative: SSH tunnel







Copy











```
ssh -N -L 18789:127.0.0.1:18789 user@host
```

- The same handshake + auth token apply over the tunnel.
- TLS + optional pinning can be enabled for WS in remote setups.

## [​](https://docs.openclaw.ai/concepts/architecture\#operations-snapshot)  Operations snapshot

- Start: `openclaw gateway` (foreground, logs to stdout).
- Health: `health` over WS (also included in `hello-ok`).
- Supervision: launchd/systemd for auto‑restart.

## [​](https://docs.openclaw.ai/concepts/architecture\#invariants)  Invariants

- Exactly one Gateway controls a single Baileys session per host.
- Handshake is mandatory; any non‑JSON or non‑connect first frame is a hard close.
- Events are not replayed; clients must refresh on gaps.

[Sandbox CLI](https://docs.openclaw.ai/cli/sandbox) [Agent](https://docs.openclaw.ai/concepts/agent)

Ctrl+I

Assistant

Responses are generated using AI and may contain mistakes.